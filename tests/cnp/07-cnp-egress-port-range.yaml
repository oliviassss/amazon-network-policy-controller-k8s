apiVersion: networking.k8s.aws/v1alpha1
kind: ClusterNetworkPolicy
metadata:
  name: cnp-egress-port-range-example
spec:
  tier: Admin
  priority: 200
  subject:
    pods:
      namespaceSelector:
        matchLabels:
          environment: production
      podSelector:
        matchLabels:
          component: backend
  egress:
  - name: allow-database-range
    action: Accept
    to:
    - namespaces:
        matchLabels:
          environment: staging
    ports:
    - portRange:
        protocol: TCP
        start: 5432
        end: 5439
  - name: allow-api-range
    action: Accept
    to:
    - networks:
      - 10.0.0.0/8
    ports:
    - portRange:
        protocol: TCP
        start: 8000
        end: 8999
